<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="水中月.镜中花.浮华一片苍凉.."><title>病毒分析-简单盗号木马 | idhyt's blog</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">病毒分析-简单盗号木马</h1><a id="logo" href="/.">idhyt's blog</a><p class="description">云淡风轻</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">病毒分析-简单盗号木马</h1><div class="post-meta">Nov 20, 2013<span> | </span><span class="category"><a href="/categories/virus/">virus</a></span></div><a data-disqus-identifier="2013/11/20/virus-troj-simple/" href="/2013/11/20/virus-troj-simple/#disqus_thread" class="disqus-comment-count"></a><div class="post-content"><p>一个简单的盗号木马简略分析</p>
<h2 id="调试环境">调试环境</h2><p>Windows xp sp3，Olldbg，010editor</p>
<h2 id="病毒简介">病毒简介</h2><p>病毒运行后会生成进91C7DF6D.cfg和91C7DF6D.dll两个文件，用作盗取用户数据发送到指定的URL地址。该过程会终止杀软进程，修改注册表信息自动运行，最后自删除。</p>
<h2 id="主要功能模块流程图">主要功能模块流程图</h2><p><img src="http://o9xrwsn0z.bkt.clouddn.com/virus-steal-s1-1.png" alt=""></p>
<h2 id="运行过程">运行过程</h2><h3 id="创建线程,进入线程执行,获取开机运行时间">创建线程,进入线程执行,获取开机运行时间</h3><p>病毒如果伪装成conime.exe，ctfmon.exe，explorer.exe中任何一个进程运行，则从C:\WINDOWS\system32\dllcache找到该进程并启动[^autorun]。</p>
<h3 id="创建91C7DF6D-cfg文件并写入数据">创建91C7DF6D.cfg文件并写入数据</h3><p>1.生成路径 C:\WINDOWS\system32\91C7DF6D.cfg 返回长度0x20<br>2.创建91C7DF6D.cfg文件。<br>3.从病毒文件偏移0x5A08处读取0x5c字节的数据，并格式化为”%02X”格式即0xB8字节将0xB8字节数据后边加上”\r\n\r\n”写入91C7DF6D.cfg文件中。</p>
<h3 id="创建91C7DF6D-dll文件并写入数据">创建91C7DF6D.dll文件并写入数据</h3><p>1.生成路径 C:\WINDOWS\system32\91C7DF6D.dll 返回长度0x20<br>2.创建91C7DF6D.dll文件。<br>3.从病毒文件偏移0x2204处读取0x3800字节数据写入91C7DF6D.dll文件中<br> 从病毒文件偏移0x5A08处读取0x60字节数据写入91C7DF6D.dll文件中</p>
<h3 id="写入注册表设置自启动">写入注册表设置自启动</h3><p>将91C7DF6D-AEF5-4136-9252-AF030D7A5931 添加到注册表  Software\microsoft\windows\currentversion\Explorer\shellexecutehooks\下随系统Explorer.exe启动。</p>
<h3 id="查找game-exe进程并终止它">查找game.exe进程并终止它</h3><p>1.将系统进程枚举，之后进行MD5加密计算。<br>2.将计算值与game.exe进程MD5值AF9C0104867ED2841389167E775B8332比较，如果相同则终止它</p>
<h3 id="删除verclsid-exe，创建注册表">删除verclsid.exe，创建注册表</h3><p>1.查找文件 C:\WINDOWS\system32\VErCLSiD.exe ，如果找到删除，防止自创建CLSID时verclsid.exe认证。<br>2.在HKEY_CLASSES_ROOT下创建注册表新子项：CLsID{91C7DF6D-AEF5-4136-9252-AF030D7A5931}\InprocServer32，值为91C7DF6D.dll和ThreadingModel<br>在Software\microsoft\windows\currentversion\Explorer\shellexecutehooks创建注册表{91C7DF6D-AEF5-4136-9252-AF030D7A5931}值为Apartment<br><img src="http://o9xrwsn0z.bkt.clouddn.com/virus-steal-s1-2.png" alt=""></p>
<h3 id="注册表操作，设置为自启动">注册表操作，设置为自启动</h3><p>1.打开注册表SOFTWARE{9184057B-D51B-4C2A-B779-EB4F548E9FDA}，如果该注册表不存在，则退出<br>2.如果该注册表存在，则枚举注册表下的所有子项并删除。<br>3.在注册表目录HKEY_LOCAL_MACHINE创建新子项SOFTWARE{9184057B-D51B-4C2A-B779-EB4F548E9FDA}<br>4.将当前进程设置为SeBackupPrivilege权限（备份注册表），删除liv<em>.tmp文件<br>5.将注册表Software\microsoft\windows\currentversion\Explorer所有项及子项备份到临时文件liv</em>.tmp文件中。<br>6.将当前进程设置为SeRestorePrivilege权限（还原注册表），从liv<em>.tmp临时文件中恢复注册表信息。<br>7.打开注册表ShellExecuteHooks\SOFTWARE{9184057B-D51B-4C2A-B779-EB4F548E9FDA}设置值的名称为｛91C7DF6D-AEF5-4136-9252-AF030D7A5931}<br>8.调用函数RegFlushKey将修改信息写入磁盘<br>9.删除临时文件liv</em>.tmp，重复一次操作确保修改注册表成功。</p>
<h3 id="加载91C7DF6D-dll运行s200函数">加载91C7DF6D.dll运行s200函数</h3><p>1.调用函数RegQueryValueExA查看注册表Software\microsoft\windows\currentversion\Explorer\shellexecutehooks{91C7DF6D-AEF5-4136-9252-AF030D7A5931}是否存在。<br>2.如果存在，则加载91C7DF6D.dll（功能见0xD）运行s200函数(功能见0xE)。<br>3.如果不存在，重复步骤0x6中的创建注册表操作</p>
<h3 id="自保护">自保护</h3><p>获取系统运行时间与0x61CC6C3(大约28.5分钟)，如果小于等于,重复设置自启动操作，总共重复三次，每次延时1s</p>
<h3 id="退出线程自删除">退出线程自删除</h3><p>1.获取病毒文件本身段路径。<br>2.调用函数GetEnvironmentVariab获得cme.exe路径<br>3.调用函数ShellExecuteA以cmd命令方式删除自身。<br>cmd.exe /c del C:\DOCUME~1\Admin...\S1.exe &gt;&gt; NUL</p>
<h3 id="91C7DF6D-dll函数功能：">91C7DF6D.dll函数功能：</h3><h4 id="结束杀软程序">结束杀软程序</h4><p>1.获取当前进程名<br>2.将进程MD5运算，然后与下列MD5值比较，如果找到就将该进程结束掉</p>
<pre><code><span class="number">5</span>AC71A9F4372CA7377C7E0C543FBFFFA safeboxtray<span class="class">.exe</span>
<span class="number">04</span>D1C083134C2EBECA57A9724B0855D4 <span class="number">360</span>tray<span class="class">.exe</span>
AE33A1F2459A12A09EC75D71D14B5E89 <span class="number">360s</span>afebox<span class="class">.exe</span>
<span class="number">3</span>ABD7CD8928FE1F3EB563F43B913CA4B <span class="number">360s</span>afe<span class="class">.exe</span>
B9E9786EAC82378D3A6E05FCC1E15D2C smartup<span class="class">.exe</span>
D7DB952BB0FA044F2B9A22FEADB37973 tqat.<span class="function"><span class="title">exe</span><span class="params">(网游安全模块)</span></span>
<span class="number">1</span>C085B8E02B137AA4EAFBE38CCF3D199
</code></pre><h4 id="判断是否为explorer-exe进程">判断是否为explorer.exe进程</h4><p>1.获取进程名MD5值与explorer.exe进程MD5值CDE09BCDF5FDE1E2EAC52C0F93362B79比较 。<br>2.如果是explorer.exe进程，调用s200函数。（功能见0xE）<br>3.如果不是explorer.exe进程，创建两个对象，一个0x5c大小(假设名字为Obj5C)，一个0x13f8大小，并进行初始化。<br>4.其中0x5c大小的对象Obj5C用作后边两个线程参数传入。该对象第一个DWORD值为函数导出表结构（0x100061dc）  第二个DWORD值为0x13f8大小的对象指针，0x18，0x24，0x30处为删除对象操作函数的指针。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">003</span>D26B0  FC <span class="number">61</span> <span class="number">00</span> <span class="number">10</span> D8 <span class="number">38</span> <span class="number">3</span>D <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>  黙.?=.........</span><br><span class="line"><span class="number">003</span>D26C0  FF FF FF FF <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">5</span>C <span class="number">62</span> <span class="number">00</span> <span class="number">10</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>  灋灋....\b.....</span><br><span class="line"><span class="number">003</span>D26D0  <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">5</span>C <span class="number">62</span> <span class="number">00</span> <span class="number">10</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>  ....\b.........</span><br><span class="line"><span class="number">003</span>D26E0  <span class="number">44</span> <span class="number">62</span> <span class="number">00</span> <span class="number">10</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>  Db.............</span><br><span class="line"><span class="number">003</span>D26F0  <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">32</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>  ...........<span class="number">.2</span>...</span><br><span class="line"><span class="number">003</span>D2700  <span class="number">64</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">0</span>D F0 AD BA <span class="number">0</span>D F0 AD BA</span><br></pre></td></tr></table></figure>
<h4 id="判断是否为game-exe进程">判断是否为game.exe进程</h4><p>1.计算进程MD5值并与game.exe进程的MD5值AF9C0104867ED2841389167E775B8332 进行比较。<br>2.如果是game.exe进程，则获取game.exe的目录，判断game.exe目录下是否存在fmod.dll文件。<br>3.如果存在fmod.dll文件，创建两个线程0x10002199和0x100021d9，两个线程的参数入参为之前生成的结构体struct。线程功能见0xE。</p>
<h4 id="注册表操作,设置为自启动项">注册表操作,设置为自启动项</h4><p>该过程同母体相同。</p>
<h3 id="S200函数功能">S200函数功能</h3><p>s200函数创建了两个线程：0x10003D94和0x10003DCF</p>
<h4 id="线程0x10003D94功能：删除托盘图标">线程0x10003D94功能：删除托盘图标</h4><p>1.通过FindWindowEx函数找到“ToolbarWindow32”托盘窗口句柄<br>2.通过函数 GetWindowThreadProcessId 获取该句柄创建者的进程explorer.exe<br>3.通过SendMessageA获取托盘数量<br>4.遍历托盘所有窗口的MD5值是否与158D0696DC5BCD4BADEE730DEA7613D8相等，如果相等就删除托盘图标。</p>
<h4 id="线程0x10003DCF功能：设置钩子监视消息队列">线程0x10003DCF功能：设置钩子监视消息队列</h4><p>1.获取进程的MD5值，验证进程MD5值是否为explorer.exe进程的MD5值CDE09BCDF5FDE1E2EAC52C0F93362B79<br>2.通过SetWindowsHookExA函数设置键盘钩子，监视消息队列。<br>3.设置死循环不断重复监视注册表是否设置为自启动，不过不存在就创建自启动，过程与0x8相同，2秒循环一次。</p>
<h3 id="game-exe下创建的两个线程功能">game.exe下创建的两个线程功能</h3><h4 id="线程0x10002199功能：设置HOOK函数，盗取用户数据">线程0x10002199功能：设置HOOK函数，盗取用户数据</h4><p>1.创建9个对象，每个对象为一个hook函数，大小为0x1D8，并进行初始化。<br>2.对象的结构如下所示(标注了几个重要的数据)：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Object(</span><br><span class="line">    <span class="number">0x00</span>：<span class="number">0x10006248</span>  <span class="comment">//删除对象函数指针</span></span><br><span class="line">    <span class="number">0x01</span>：********   <span class="comment">//0x100074B4处读取的数据</span></span><br><span class="line">    ...</span><br><span class="line">    ...</span><br><span class="line">    <span class="number">0x84</span>：<span class="number">0x100037E3</span> <span class="comment">//hook地址</span></span><br><span class="line">    <span class="number">0x88</span>：<span class="number">0x8B0000</span>  <span class="comment">//申请的堆块地址，存放着将要查找的特征值</span></span><br><span class="line">    <span class="number">0x8c</span>：<span class="number">0x8C0000</span>  <span class="comment">//申请的堆块地址，存放着将要查找的特征值</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="number">0x9c</span>：<span class="number">0x8</span> <span class="comment">//特征值的字节数</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="number">0xB0</span>: <span class="number">1</span>   <span class="comment">//对象操作成功置1，否则为0</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="number">0x1BC</span>：<span class="number">0x400000</span>  <span class="comment">//当前进程模块基址，即game.exe进程基址</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="number">0x1D0</span>：next ObjPtr <span class="comment">//存放着下一个对象的指针</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>3.将创建的9个对象生成单向链表结构，并初始化。然后将相关信息填写到对象Object中。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Object (</span><br><span class="line">    <span class="number">0x00</span>：<span class="number">0x100061fc</span>  <span class="comment">//指向一些函数导出表</span></span><br><span class="line">    <span class="number">0x04</span>：<span class="number">0x003D38D8</span> <span class="comment">//0x13f8大小的对象指针</span></span><br><span class="line">    <span class="number">0x08</span>：<span class="number">1</span>   <span class="comment">//标志位，初始为0，特征值查找完以后置1</span></span><br><span class="line">    ......</span><br><span class="line">    <span class="number">0x30</span>：<span class="number">0x10006244</span>  <span class="comment">//指向删除对象函数指针</span></span><br><span class="line">    <span class="number">0x34</span>：<span class="number">0x003D4CE8</span>  <span class="comment">//第一个对象指针</span></span><br><span class="line">    <span class="number">0x38</span>：<span class="number">0x003D5C68</span>  <span class="comment">//最后一个对象指针</span></span><br><span class="line">    <span class="number">0x3c</span>：nextPtr       <span class="comment">//存放下一个操作的对象指针，操作完成置0</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>4.创建线程0x10003481<br>4.1 解密出URL：<a href="http://www.y0uku1.com/cia/bike.asp，方法同线程0x100021d9" target="_blank" rel="external">http://www.y0uku1.com/cia/bike.asp，方法同线程0x100021d9</a><br>4.2 生成新的URL：<a href="http://www.y0uku1.com/cia/mb.asp" target="_blank" rel="external">http://www.y0uku1.com/cia/mb.asp</a><br>4.3 通过函数GetComputerNameA得到计算机名字<br>4.4 按照格式”?A=%s&amp;c=%s&amp;u=%s”生成新的URL <a href="http://www.y0uku1.com/cia/mb.asp?A=putip&amp;c=TEST-D43880C7BB&amp;u=" target="_blank" rel="external">http://www.y0uku1.com/cia/mb.asp?A=putip&amp;c=TEST-D43880C7BB&amp;u=</a><br>4.5 从URL中读取数据，过程同线程0x100021d9中的0x3<br>4.6 延时10秒退出。</p>
<p>5.在当前进程中查找特征值<br>5.1 通过IsbadReadPtr函数判断进程基址开始的0x1000字节是否具有访问权限。<br>5.2 如果具有访问权将0x1000字节的数据读到内存中，然后与特征值匹配，如果找到特征值，则返回偏移量，之后加上基址得到绝对地址。<br>5.3 如果查找不到特征值则继续从进程中拷贝数据，每次0x1000字节，知道将当前进程搜索完。</p>
<p>6.设置Hook函数, 记录键盘数据发送的指定的链接地址。<br>该处举例子说明，如果在当前进程0x400004出找到了特征值，则将该处改为jmp 3F0000，在3F0000处代码为jmp 100037E8，这样当游戏进程启动时就会跳转到dll里边执行相应的操作，执行完之后再跳回去。如下图所示：<br><img src="http://o9xrwsn0z.bkt.clouddn.com/virus-steal-s1-3.png" alt=""></p>
<h4 id="线程0x100021d9功能：解密url，下载数据">线程0x100021d9功能：解密url，下载数据</h4><p>1.解密URL<br>1.1 读取91C7DF6D.dll文件中数据，去掉\r\n<br>1.2 DB2C93C09AD60F3BC9A2C35EDF1D148220000002200000072F18A7B04B578B3FCDA357BEAB38D0A2BAB9D6453B534ADEA82796BB1A3C81E69F572F18A7B04B578B3FCDA357BEAB38D0A2BAB9D6453B534ADEA82796BB1A3C81E69F5<br>1.3 将偏移0x18处开始的0x22个的数据分别与前0x10字节的数据相异或，再与0x37相异或得到解密的URL地址为<a href="http://www.y0uku1.com/cia/bike.asp" target="_blank" rel="external">http://www.y0uku1.com/cia/bike.asp</a></p>
<p>2.生成最终URL<br>2.1 获取cfg文件的前六个字节数据2DB2C9进行MD5加密，得到长度为0x10，然后再按照”%02X”格式生成0x20大小的数据18CE4D37773396E1332CCEAD3196AF50<br>2.2 最后按照一定的格式生成最终的URL链接：<br><a href="http://www.y0uku1.com/cia/bike.asp?Re=&amp;s=&amp;A=&amp;P=&amp;MB=&amp;wwwww=v&amp;H=&amp;PIN=&amp;R=&amp;RG=-1&amp;M=-1&amp;M1=-1&amp;mac=&amp;RG1=-1&amp;Z=:18CE4D37773396E1332CCEAD3196AF50" target="_blank" rel="external">http://www.y0uku1.com/cia/bike.asp?Re=&amp;s=&amp;A=&amp;P=&amp;MB=&amp;wwwww=v&amp;H=&amp;PIN=&amp;R=&amp;RG=-1&amp;M=-1&amp;M1=-1&amp;mac=&amp;RG1=-1&amp;Z=:18CE4D37773396E1332CCEAD3196AF50</a></p>
<p>3.访问链接下载数据<br>3.1 加载wininet.dll找到InternetOpenUrl函数地址<br>3.2 打开本地目录C:\Windows\System32\下的wininet.dll文件，然后从偏移0x14E5A处读取0x10字节数据，判断是否与得到的InternetOpenUrl函数地址不相同，则将InternetOpenUrl函数地址写入该处，之后调用InternetOpenUrl函数打开链接<a href="http://www.y0uku1.com/cia/mb.asp?A=putip&amp;c=TEST-D43880C7BB&amp;u=" target="_blank" rel="external">http://www.y0uku1.com/cia/mb.asp?A=putip&amp;c=TEST-D43880C7BB&amp;u=</a><br>下载数据，大小为0x104字节。<br>3.3 延时2分钟，然后循环下载数据。</p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://blog.idhyt.com/2013/11/20/virus-troj-simple/" data-id="civkfle6j000do66i2kcfm4je" class="article-share-link">Share</a><div class="tags"><a href="/tags/盗号/">盗号</a></div><div class="post-nav"><a href="/2013/11/25/virus-infected-rmnet/" class="pre">病毒分析-rmnet感染型</a><a href="/2013/11/18/virus-download/" class="next">病毒分析-简单下载者</a></div><div id="disqus_thread"><script>var disqus_shortname = 'idhyt';
var disqus_identifier = '2013/11/20/virus-troj-simple/';
var disqus_title = '病毒分析-简单盗号木马';
var disqus_url = 'http://blog.idhyt.com/2013/11/20/virus-troj-simple/';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//idhyt.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><input placeholder="Search" type="text" class="st-default-search-input"/></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Social</i></div><ul></ul><a href="http://github.com/idhyt" title="GitHub" target="_blank">GitHub</a><ul></ul><a href="https://twitter.com/idhyt3r" title="Twitter" target="_blank">Twitter</a><ul></ul><a href="http://weibo.com/idhyt" title="Weibo" target="_blank">Weibo</a><ul></ul><a href="http://www.zhihu.com/people/idhyt" title="ZhiHu" target="_blank">ZhiHu</a></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/android/">android</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/diary/">diary</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/exploit/">exploit</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/study/">study</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/technic/">technic</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/virus/">virus</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/cve/" style="font-size: 15px;">cve</a> <a href="/tags/淘宝客/" style="font-size: 15px;">淘宝客</a> <a href="/tags/过滤/" style="font-size: 15px;">过滤</a> <a href="/tags/盗号/" style="font-size: 15px;">盗号</a> <a href="/tags/推广/" style="font-size: 15px;">推广</a> <a href="/tags/流氓/" style="font-size: 15px;">流氓</a> <a href="/tags/感染/" style="font-size: 15px;">感染</a> <a href="/tags/下载/" style="font-size: 15px;">下载</a> <a href="/tags/xss/" style="font-size: 15px;">xss</a> <a href="/tags/sql/" style="font-size: 15px;">sql</a> <a href="/tags/lol/" style="font-size: 15px;">lol</a> <a href="/tags/shellcode/" style="font-size: 15px;">shellcode</a> <a href="/tags/english/" style="font-size: 15px;">english</a> <a href="/tags/challenge/" style="font-size: 15px;">challenge</a> <a href="/tags/task/" style="font-size: 15px;">task</a> <a href="/tags/thread/" style="font-size: 15px;">thread</a> <a href="/tags/uac/" style="font-size: 15px;">uac</a> <a href="/tags/驱动/" style="font-size: 15px;">驱动</a> <a href="/tags/nvidia/" style="font-size: 15px;">nvidia</a> <a href="/tags/kernel/" style="font-size: 15px;">kernel</a> <a href="/tags/symbol/" style="font-size: 15px;">symbol</a> <a href="/tags/libstagefright/" style="font-size: 15px;">libstagefright</a> <a href="/tags/pingpongroot/" style="font-size: 15px;">pingpongroot</a> <a href="/tags/iovyroot/" style="font-size: 15px;">iovyroot</a> <a href="/tags/pxn/" style="font-size: 15px;">pxn</a> <a href="/tags/无法描述/" style="font-size: 15px;">无法描述</a> <a href="/tags/smali/" style="font-size: 15px;">smali</a> <a href="/tags/debug/" style="font-size: 15px;">debug</a> <a href="/tags/xposed/" style="font-size: 15px;">xposed</a> <a href="/tags/adb/" style="font-size: 15px;">adb</a> <a href="/tags/webview/" style="font-size: 15px;">webview</a> <a href="/tags/android/" style="font-size: 15px;">android</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/11/09/exploit-kernel-security-flaws/">KERNEL SECURITY FLAWS (0day for nexus4)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/26/exploit-illegal-access-caused-by-an-empty-list/">ILLEGAL ACCESS CAUSED BY AN EMPTY LIST</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/24/exploit-cve-2016-5195/">CVE-2016-5195</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/04/exploit-perf_event-vul/">PERF_EVENT VUL</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/09/exploit-bypass-pxn/">绕过PXN保护</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/07/exploit-cve-2015-1805/">CVE-2015-1805</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/09/exploit-process-descriptor/">进程描述符</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/09/exploit-kernel-symbol-usage/">如何优雅的使用内核符号表</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/02/diary-stay-away-trip/">一场说走就走的旅行</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/06/diary-work-harder/">一定要更加努力</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> Recent Comments</i></div><script type="text/javascript" src="//idhyt.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="http://blog.idhyt.com/about" title="About" target="_blank">About</a><ul></ul><a href="undefined" title="undefined" target="_blank"></a><ul></ul><a href="undefined" title="undefined" target="_blank"></a><ul></ul><a href="undefined" title="undefined" target="_blank"></a><ul></ul><a href="undefined" title="undefined" target="_blank"></a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">idhyt's blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><!-- a(rel='nofollow', target='_blank', href='https://github.com/tufu9441/maupassant-hexo')  Theme--><!-- |  by--><!-- a(rel='nofollow', target='_blank', href='https://github.com/pagecho')  Cho.--></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

_st('install','sVJDxDCDcUGeK1KkM6zN','2.0.0');
</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-71783676-1','auto');ga('send','pageview');
</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?5228d77c5752954f270fcca0908555af";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>