<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="水中月.镜中花.浮华一片苍凉.."><title>python challenge 11-20 | idhyt's blog</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">python challenge 11-20</h1><a id="logo" href="/.">idhyt's blog</a><p class="description">云淡风轻</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">python challenge 11-20</h1><div class="post-meta">Aug 10, 2015<span> | </span><span class="category"><a href="/categories/python/">python</a></span></div><a data-disqus-identifier="2015/08/10/python-challenge-11-20/" href="/2015/08/10/python-challenge-11-20/#disqus_thread" class="disqus-comment-count"></a><div class="post-content"><p>接上边继续斗智斗勇中。越来越觉得智商不够用了。。</p>
<h3 id="python_challenge_11"><a href="http://www.pythonchallenge.com/pc/return/5808.html" target="_blank" rel="external">python challenge 11</a></h3><p><code>http://www.pythonchallenge.com/pc/return/5808.html</code><br><img src="http://o9xrwsn0z.bkt.clouddn.com/python-challenge-11.jpg" alt="11"><br>题目只有一张模糊的图片，源码也没什么提示，看页面title为odd even.<br>猜测这张模糊的图片是否是将两张图片合成的，因此将其奇偶坐标分离开.<br>分离坐标有四种情况，(odd, odd),(odd, even),(even, odd),(even, even).<br>我这里取双奇偶坐标(odd, odd)和(even, even).<br>在PIL库中，使用load函数的效果比使用putpixel和getpixel更高效，因此选择使用load函数.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">odd_even</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">    im = Image.open(<span class="string">"img/python-challenge-11.jpg"</span>)</span><br><span class="line">    w, h = im.size</span><br><span class="line"></span><br><span class="line">    imgs = [Image.new(im.mode, (w / <span class="number">2</span>, h / <span class="number">2</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">2</span>)]</span><br><span class="line">    imgs_load = [img.load() <span class="keyword">for</span> img <span class="keyword">in</span> imgs]</span><br><span class="line">    org = im.load()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(w):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> xrange(h):</span><br><span class="line">            <span class="keyword">if</span> (i + j) % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">                org_pos = (i, j)</span><br><span class="line">                new_pos = (i / <span class="number">2</span>, j / <span class="number">2</span>)</span><br><span class="line">                imgs_load[i % <span class="number">2</span>][new_pos] = org[org_pos]</span><br><span class="line"></span><br><span class="line">    [imgs[i].save(<span class="string">'img/python-challenge-11-%d.jpg'</span> % i) <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">2</span>)]</span><br></pre></td></tr></table></figure></p>
<p>最后生成的两张图片是一样的<br><img src="http://o9xrwsn0z.bkt.clouddn.com/python-challenge-11-evil.jpg" alt="11-evil"><br>显示的单词evil即为答案。</p>
<h3 id="python_challenge_12"><a href="http://www.pythonchallenge.com/pc/return/evil.html" target="_blank" rel="external">python challenge 12</a></h3><p><code>http://www.pythonchallenge.com/pc/return/evil.html</code><br><img src="http://o9xrwsn0z.bkt.clouddn.com/python-challenge-12.jpg" alt="12"><br>一张没有什么异常的图片，查看下源码，注意看图片名字，evil1.jpg，这里应该尝试下evil2.jpg了。<br>evil2.jpg -&gt; not jpg –gfx<br>evil3.jpg -&gt; no more evils…<br>evil4.jpg -&gt; Bert is evil! go back!(只在ie中可看到)<br>根据这些提示，先将evil2.jpg改为evil2.gfx，得到这个文件<br>GFX文件格式：GFX是一套跨平台的图形生成包，是一种可用于交互的图形格式，详情百度下。<br>到这里就没有思路了，看了下提示才知道，原来原图那人把扑克牌分成5堆，要把那个gfx文件用分牌的方式分成5个文件。<br>gfx的第一个字节给第一个文件，第二个字节给第二个文件，第三个字节给第三个文件，第四个字节给第四个文件，第五个字节给第五个文件，第六个字节给第一个文件……<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">evil</span><span class="params">()</span>:</span></span><br><span class="line">    f = open(<span class="string">'files/evil2.gfx'</span>, <span class="string">'rb+'</span>)</span><br><span class="line">    content = f.read()</span><br><span class="line">    f.close()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">5</span>):</span><br><span class="line">        f = open(<span class="string">'files/evil2-%d.jpg'</span> % i, <span class="string">'wb+'</span>)</span><br><span class="line">        f.write(content[i::<span class="number">5</span>])</span><br><span class="line">        f.close()</span><br></pre></td></tr></table></figure></p>
<p>最后得到5张图片连接起来即为结果:disproportional<br><img src="http://o9xrwsn0z.bkt.clouddn.com/python-challenge-12-evil2.jpg" alt="12-evil2"></p>
<h3 id="python_challenge_13"><a href="http://www.pythonchallenge.com/pc/return/disproportional.html" target="_blank" rel="external">python challenge 13</a></h3><p><code>http://www.pythonchallenge.com/pc/return/disproportional.html</code><br><img src="http://o9xrwsn0z.bkt.clouddn.com/python-challenge-13.jpg" alt="13"><br>这个页面显示了一个电话按键，并且标题为call him，很明显是要拨打一个电话号码。<br>图片最下边提示phone that evil，再回头看那个evil4.jpg的提示，Bert is evil! go back!<br>所以是要打电话给Bert,怎么打，不可能用自己手机打吧！然后在页面到处点点，一不小心点到了5就进去了。<br>进入页面：<a href="http://www.pythonchallenge.com/pc/phonebook.php" target="_blank" rel="external">http://www.pythonchallenge.com/pc/phonebook.php</a><br>这是什么鬼，止步于此，开始度娘。。。<br>xmlrpc是使用http协议做为传输协议的rpc机制，使用xml文本的方式传输命令和数据blablabla…<br>反正就是要用到python的<a href="https://docs.python.org/2/library/xmlrpclib.html" target="_blank" rel="external">xmlrpclib模块</a>来连接这个php页面，然后查看其方法，其中有个名为phone方法就是答案。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">disproportional</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">import</span> xmlrpclib</span><br><span class="line">    xml_rpc = xmlrpclib.ServerProxy(<span class="string">"http://www.pythonchallenge.com/pc/phonebook.php"</span>)</span><br><span class="line">    <span class="keyword">print</span> xml_rpc.system.listMethods()</span><br><span class="line">    <span class="keyword">print</span> xml_rpc.system.methodHelp(<span class="string">'phone'</span>)</span><br><span class="line">    <span class="keyword">print</span> xml_rpc.phone(<span class="string">'Bert'</span>)</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>[<span class="string">'phone'</span>, <span class="string">'system.listMethods'</span>, <span class="string">'system.methodHelp'</span>, <span class="string">'system.methodSignature'</span>, <span class="string">'system.multicall'</span>, <span class="string">'system.getCapabilities'</span>]</span><br><span class="line">    Returns the phone of a person</span><br><span class="line">    <span class="number">555</span>-ITALY</span><br></pre></td></tr></table></figure></p>
<p>最后输入555-ITALY.html不行。。改为ITALY.html提示SMALL letters。。好吧。。italy.html</p>
<h3 id="python_challenge_14"><a href="http://www.pythonchallenge.com/pc/return/italy.html" target="_blank" rel="external">python challenge 14</a></h3><p><code>http://www.pythonchallenge.com/pc/return/italy.html</code><br><img src="http://o9xrwsn0z.bkt.clouddn.com/python-challenge-14.jpg" alt="14"><br>所有提示信息：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">根据网页标题的提示：walk around</span><br><span class="line">网页源码的提示：<span class="number">100</span>*<span class="number">100</span> = (<span class="number">100</span>+<span class="number">99</span>+<span class="number">99</span>+<span class="number">98</span>) + (...</span><br><span class="line">下边那张图wire.png点开标题为<span class="number">10000</span>*<span class="number">1</span></span><br></pre></td></tr></table></figure></p>
<p>先验证序列公式<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 100*100 = (100+99+99+98) + (...</span></span><br><span class="line">items = [i + i-<span class="number">1</span> + i-<span class="number">1</span> + i-<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">100</span>, <span class="number">1</span>, -<span class="number">2</span>)]</span><br><span class="line">items_value = reduce(<span class="keyword">lambda</span> x, y: x+y, items)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"%d %d"</span> % (len(items), items_value)</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="number">50</span> <span class="number">10000</span></span><br></pre></td></tr></table></figure></p>
<p>可知该序列公式是正确的。<br>10000x1 = 100x100是否要重新组图，按照这个思路把10000个像素重组<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">org_img = Image.open(<span class="string">'img/wire.png'</span>)</span><br><span class="line">org_data = list(org_img.getdata())</span><br><span class="line">res_img = Image.new(org_img.mode, (<span class="number">100</span>, <span class="number">100</span>))</span><br><span class="line">res_data = res_img.load()</span><br><span class="line">org_index = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> xrange(<span class="number">100</span>):</span><br><span class="line">        res_data[j, i] = org_data[org_index]</span><br><span class="line">        org_index += <span class="number">1</span></span><br><span class="line">res_img.save(<span class="string">"img/wire-0.png"</span>)</span><br></pre></td></tr></table></figure></p>
<p>最开始是按照先行后列的方式重组发现图片是反的，然后按照先列后行的方式重组，得到一个图片。<br><img src="http://o9xrwsn0z.bkt.clouddn.com/python-challenge-14-bit.png" alt="14-bit"><br>万分欣喜，进入bit.html页面就傻了：you took the wrong curve.<br>真是个悲伤的故事。。。<br>下边就完全没有任何头绪，只要又要借助度娘了，最后得到的解题思路是：<br>将10000x1的那张图片按照序列化的格式进行重新生成100x100的图片，生成的逻辑是：<br>按照图片面包的方向，从右边开始，外向内绕圈圈，<br>先向一个方向走100个像素，然后转90度，走99个像素，再转90度，再走99个像素，再转90度，再走98个像素，这样就完成了一个圈。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">italy</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">    <span class="comment"># 100*100 ＝ （100 + 99 + 99 + 98)+(...</span></span><br><span class="line">    items = [[i, i-<span class="number">1</span>, i-<span class="number">1</span>, i-<span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">100</span>, <span class="number">1</span>, -<span class="number">2</span>)]</span><br><span class="line"></span><br><span class="line">    org_img = Image.open(<span class="string">'img/wire.png'</span>)</span><br><span class="line">    org_data = list(org_img.getdata())</span><br><span class="line">    new_img = Image.new(org_img.mode, (<span class="number">100</span>, <span class="number">100</span>))</span><br><span class="line">    new_data = new_img.load()</span><br><span class="line"></span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    x = y = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> items:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> xrange(item[<span class="number">0</span>]):</span><br><span class="line">            new_data[x, y] = org_data[index]</span><br><span class="line">            x += <span class="number">1</span></span><br><span class="line">            index += <span class="number">1</span></span><br><span class="line">        x -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> xrange(item[<span class="number">1</span>]):</span><br><span class="line">            new_data[x, y] = org_data[index]</span><br><span class="line">            y += <span class="number">1</span></span><br><span class="line">            index += <span class="number">1</span></span><br><span class="line">        y -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> xrange(item[<span class="number">2</span>]):</span><br><span class="line">            new_data[x, y] = org_data[index]</span><br><span class="line">            x -= <span class="number">1</span></span><br><span class="line">            index += <span class="number">1</span></span><br><span class="line">        x += <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> xrange(item[<span class="number">3</span>]):</span><br><span class="line">            new_data[x, y] = org_data[index]</span><br><span class="line">            y -= <span class="number">1</span></span><br><span class="line">            index += <span class="number">1</span></span><br><span class="line">        y += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    new_img.save(<span class="string">'img/wire-cat.png'</span>)</span><br></pre></td></tr></table></figure></p>
<p>最后得到了一张图片<br><img src="http://o9xrwsn0z.bkt.clouddn.com/python-challenge-14-cat.png" alt="14-cat"><br>然后输入cat.html进入页面，出现了两只猫的图片，并有一段说明：<br>and its name is uzi. you’ll hear from him later.<br>替换为uzi.html进入下一题，uzi不是小狗吗 = =!</p>
<h3 id="python_challenge_15"><a href="http://www.pythonchallenge.com/pc/return/uzi.html" target="_blank" rel="external">python challenge 15</a></h3><p><code>http://www.pythonchallenge.com/pc/return/uzi.html</code><br><img src="http://o9xrwsn0z.bkt.clouddn.com/python-challenge-15.jpg" alt="15"></p>
<p>先找到所有有用的提示：</p>
<ul>
<li>图片信息<br>1**6年1月26日<br>右下角2月份有29天 说明是闰年 且2月29日为周日</li>
<li>页面标题<br>whom 猜测应该是找人</li>
<li><p>网页源码<br>he ain’t the youngest, he is the second # 应该是找到一个年龄列表中第二年轻的<br>buy flowers for tomorrow # 结合1月26日应该是说明天即1月27日有事件发生</p>
</li>
<li><p>结合以上信息<br>应该是找到1**6年中的所有闰年，且2月29日为周一的时间中第二个年轻的年份，<br>然后加上1月27日得到一个事件时间，这个时间和一个人有关系。</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># run in python 3.0+</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">uzi</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_week_day</span><span class="params">(year_, mouth_, day_)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> datetime(year_, mouth_, day_).strftime(<span class="string">"%w"</span>)</span><br><span class="line"></span><br><span class="line">    leap_years = [i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1006</span>, <span class="number">1997</span>, <span class="number">10</span>) <span class="keyword">if</span> (i % <span class="number">4</span> == <span class="number">0</span> <span class="keyword">and</span> i % <span class="number">100</span> != <span class="number">0</span>) <span class="keyword">or</span> i % <span class="number">400</span> == <span class="number">0</span>]</span><br><span class="line">    <span class="comment"># print (leap_years)</span></span><br><span class="line">    match_year = [y <span class="keyword">for</span> y <span class="keyword">in</span> leap_years <span class="keyword">if</span> get_week_day(y, <span class="number">2</span>, <span class="number">29</span>) == <span class="string">"0"</span>]</span><br><span class="line">    <span class="keyword">print</span> (match_year)</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"%d-01-17"</span> % match_year[-<span class="number">2</span>])</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>[<span class="number">1176</span>, <span class="number">1356</span>, <span class="number">1576</span>, <span class="number">1756</span>, <span class="number">1976</span>]</span><br><span class="line">    <span class="number">1756</span>-<span class="number">01</span>-<span class="number">17</span></span><br></pre></td></tr></table></figure>
<p>由于python2.7版本中the datetime strftime() methods require year &gt;= 1900,<br>因此该代码需要运行在python3.0+<br>最后百度关键词1756年1月27日，著名的音乐大师沃尔弗于格·莫扎特(mozart),诞生于奥地利查尔茨堡。<br>诞生于，诞生啊。。其实最初我以为送花是第二天有人挂掉了去拜祭。。面壁思过中。。。</p>
<h3 id="python_challenge_16"><a href="http://www.pythonchallenge.com/pc/return/mozart.html" target="_blank" rel="external">python challenge 16</a></h3><p><code>http://www.pythonchallenge.com/pc/return/mozart.html</code><br><img src="http://o9xrwsn0z.bkt.clouddn.com/python-challenge-16.gif" alt="16"><br>页面标题提示：let me get this straight<br>观察图片将粉色的线条对齐排成一列，即将每行像素点循环左移知道粉色点位于最左边。<br>其中图片模式为索引像素模式，用ps查看得到粉色Idx=195,对应RGB=(255, 0, 255)。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mozart</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">    org_img = Image.open(<span class="string">'img/mozart.gif'</span>)</span><br><span class="line">    org_size = org_img.size</span><br><span class="line">    org_data = list(org_img.getdata())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># new_img = Image.new(org_img.mode, org_size)</span></span><br><span class="line">    new_img = org_img.copy()</span><br><span class="line">    new_data = new_img.load()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(org_size[<span class="number">1</span>]):</span><br><span class="line">        line_pixels = org_data[org_size[<span class="number">0</span>] * y: org_size[<span class="number">0</span>] * (y + <span class="number">1</span>)]</span><br><span class="line">        pink_index = line_pixels.index(<span class="number">195</span>)</span><br><span class="line">        <span class="keyword">for</span> x, pixel <span class="keyword">in</span> enumerate(line_pixels[pink_index:] + line_pixels[:pink_index]):</span><br><span class="line">            new_data[x, y] = pixel</span><br><span class="line"></span><br><span class="line">    new_img.save(<span class="string">"img/romance.gif"</span>)</span><br></pre></td></tr></table></figure></p>
<p>最后生成答案图片<br><img src="http://o9xrwsn0z.bkt.clouddn.com/python-challenge-16-romance.gif" alt="16-romance"></p>
<h3 id="python_challenge_17"><a href="http://www.pythonchallenge.com/pc/return/romance.html" target="_blank" rel="external">python challenge 17</a></h3><p><code>http://www.pythonchallenge.com/pc/return/romance.html</code><br><img src="http://o9xrwsn0z.bkt.clouddn.com/python-challenge-17.jpg" alt="17"><br>做这个题请自觉开启自虐模式，不要问我为什么，我只想静静。<br>页面标题：eat? 看下源代码图片名字为cookies.jpg<br>cookies点心？cookie?打开chrome控制台输入alert(document.cookie)<br><img src="http://o9xrwsn0z.bkt.clouddn.com/python-challenge-17-alert.jpg" alt="17-alert"><br>you should have followed busynothing…<br>结合图片左下角linkedlist页面的图片，想到之前遍历时候找的每个页面，这个应该是遍历找每个页面的cookie信息了。<br>初步验证，先进入linkedlist的第一个节点：<br><a href="http://www.pythonchallenge.com/pc/def/linkedlist.php?busynothing=12345" target="_blank" rel="external">http://www.pythonchallenge.com/pc/def/linkedlist.php?busynothing=12345</a><br>页面内容：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">If you came here <span class="keyword">from</span> level <span class="number">4</span> - go back!</span><br><span class="line">You should follow the obvious chain...</span><br><span class="line"></span><br><span class="line"><span class="keyword">and</span> the next busynothing <span class="keyword">is</span> <span class="number">44827</span></span><br></pre></td></tr></table></figure></p>
<p>大概意思是说这个界面如果你是从第四关跳进去的话请返回,显示的关键字会是nothing而非busynothing。<br>因此一定要从第一个节点进入，不要从linkedlist.php点击图片进入，否则获取不到cookie信息。<br>弹出的cookie信息为：info=B<br>第二个节点：<a href="http://www.pythonchallenge.com/pc/def/linkedlist.php?busynothing=44827" target="_blank" rel="external">http://www.pythonchallenge.com/pc/def/linkedlist.php?busynothing=44827</a><br>弹出的cookie信息为：info=Z<br>是不是有点眼熟，回头找找第8关的BZ2压缩。。<br>之后是写代码之路，其中cookie模块参考：<a href="http://my.oschina.net/duhaizhang/blog/69342" target="_blank" rel="external">urllib2模块、cookielib模块</a><br>遍历完cookie信息后得到字符串：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BZh91AY%<span class="number">26</span>SY%<span class="number">94</span>%<span class="number">3</span>A%E2I%<span class="number">00</span>%<span class="number">00</span>%<span class="number">21</span>%<span class="number">19</span>%<span class="number">80</span>P%<span class="number">81</span>%<span class="number">11</span>%<span class="number">00</span>%AFg%<span class="number">9</span>E%A0+%<span class="number">00</span>hE%<span class="number">3</span>DM%B5%<span class="number">23</span>%D0%D4%D1%E2%<span class="number">8</span>D%<span class="number">06</span>%A9%FA%<span class="number">26</span>S%D4%D3%<span class="number">21</span>%A1%EAi7h%<span class="number">9</span>B%<span class="number">9</span>A%<span class="number">2</span>B%BF%<span class="number">60</span>%<span class="number">22</span>%C5WX%E1%ADL%<span class="number">80</span>%E8V%<span class="number">3</span>C%C6%A8%DBH%<span class="number">2632</span>%<span class="number">18</span>%A8x%<span class="number">01</span>%<span class="number">08</span>%<span class="number">21</span>%<span class="number">8</span>DS%<span class="number">0</span>B%C8%AF%<span class="number">96</span>KO%CA2%B0%F1%BD%<span class="number">1</span>Du%A0%<span class="number">86</span>%<span class="number">05</span>%<span class="number">92</span>s%B0%<span class="number">92</span>%C4Bc%F1w%<span class="number">24</span>S%<span class="number">85</span>%<span class="number">09</span>%<span class="number">09</span>C%AE%<span class="number">24</span></span><br></pre></td></tr></table></figure></p>
<p>看看格式应该是转义过的，调用urllib转义函数得到结果：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BZh91AY&amp;SY\x94:\xe2I\x00\x00!\x19\x80P\x81\x11\x00\xafg\x9e\xa0 \x00hE=M\xb5<span class="comment">#\xd0\xd4\xd1\xe2\x8d\x06\xa9\xfa&amp;S\xd4\xd3!\xa1\xeai7h\x9b\x9a+\xbf`"\xc5WX\xe1\xadL\x80\xe8V&lt;\xc6\xa8\xdbH&amp;32\x18\xa8x\x01\x08!\x8dS\x0b\xc8\xaf\x96KO\xca2\xb0\xf1\xbd\x1du\xa0\x86\x05\x92s\xb0\x92\xc4Bc\xf1w$S\x85\t\tC\xae$\x90</span></span><br></pre></td></tr></table></figure></p>
<p>这个看着就很熟悉了，调用bz2进行解压<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">is it the 26th already? call his father and inform him that "the flowers are on their way". he'll understand.</span><br></pre></td></tr></table></figure></p>
<p>这个结果看的也是格外的忧伤，竟然还有这么多的坑。。看看26th说的是莫扎特，查下莫扎特的老爹为Leopold。<br>试试Leopold.html,404啊，404！！！<br>再仔细看，call his father，打电话，电话！！！<br>调用13关的代码Bert改为Leopold返回555-VIOLIN<br>参考13关去数字改小写地址为violin.html，竟然还有，呵呵哒。。。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">no! i mean yes! but ../stuff/violin.php.</span><br></pre></td></tr></table></figure></p>
<p>再改将上级目录改为/stuff/violin.php<br>即<a href="http://www.pythonchallenge.com/pc/stuff/violin.php" target="_blank" rel="external">http://www.pythonchallenge.com/pc/stuff/violin.php</a><br>看到图片我以为终于完了，仔细一看，编号呢，没编号肯定还是个坑啊，我内心几乎是崩溃的。。<br><img src="http://o9xrwsn0z.bkt.clouddn.com/python-challenge-17-violin.jpg" alt="17-violin"></p>
<p>看下页面提示标题：it’s me. what do you want?<br>返回页面也没有什么其他信息，答案在哪里？！？！？<br>想想这个题主题是cookie,回头再看上边的解压出来的提示信息，后半句还没有用到。<br>inform him that “the flowers are on their way”<br>翻译是告诉他鲜花已经来路上，暗示要给他携带信息。<br>也就是说要带上info=”the flowers are on their way”消息去访问这个页面！<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cj._cookies.values()[<span class="number">0</span>][<span class="string">'/'</span>][<span class="string">'info'</span>].value = <span class="string">'the+flowers+are+on+their+way'</span></span><br><span class="line">violin_source = opener.open(<span class="string">'http://www.pythonchallenge.com/pc/stuff/violin.php'</span>).read()</span><br><span class="line"><span class="keyword">print</span> violin_source</span><br></pre></td></tr></table></figure></p>
<p>打印出来的页面：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;title&gt;it's me. what do you want?&lt;/title&gt;</span><br><span class="line">  &lt;link rel="stylesheet" type="text/css" href="../style.css"&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;br&gt;&lt;br&gt;</span><br><span class="line">    &lt;center&gt;&lt;font color="gold"&gt;</span><br><span class="line">    &lt;img src="leopold.jpg" border="0"/&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;</span><br><span class="line">oh well, don't you dare to forget the balloons.&lt;/font&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p>终于出结果了，balloons，感觉已经可以开始google大法了QAQ。。</p>
<p>完整逻辑代码，其中略掉level13的代码：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">romance</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">import</span> urllib2</span><br><span class="line">    <span class="keyword">import</span> cookielib</span><br><span class="line">    <span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line">    cj = cookielib.CookieJar()</span><br><span class="line">    handler = urllib2.HTTPCookieProcessor(cj)</span><br><span class="line">    opener = urllib2.build_opener(handler)</span><br><span class="line"></span><br><span class="line">    base_url = <span class="string">"http://www.pythonchallenge.com/pc/def/linkedlist.php"</span></span><br><span class="line">    param = <span class="string">"12345"</span></span><br><span class="line">    times = <span class="number">1</span></span><br><span class="line">    info = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            url = <span class="string">"?busynothing="</span>.join([base_url, param])</span><br><span class="line">            page_source = opener.open(url).read()</span><br><span class="line">            param = re.findall(<span class="string">"and the next busynothing is ([0-9]+)"</span>, page_source)[<span class="number">0</span>]</span><br><span class="line">            ck = cj._cookies.values()[<span class="number">0</span>][<span class="string">'/'</span>][<span class="string">'info'</span>].value</span><br><span class="line">            info.append(ck)</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"%d -&gt; %s -&gt; %s"</span> % (times, param, ck)</span><br><span class="line">            times += <span class="number">1</span></span><br><span class="line">        <span class="comment"># 匹配不到跳到异常</span></span><br><span class="line">        <span class="keyword">except</span> IndexError:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"the end is : %d"</span> % times</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    message = <span class="string">""</span>.join(info)</span><br><span class="line">    <span class="keyword">print</span> message</span><br><span class="line">    <span class="comment"># 转义</span></span><br><span class="line">    message = urllib.unquote_plus(message)</span><br><span class="line">    result = message.decode(<span class="string">"bz2"</span>)</span><br><span class="line">    <span class="keyword">print</span> result</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ---level 13 code ---#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># url = "?busynothing=".join([base_url, param])</span></span><br><span class="line">    <span class="comment"># page_source = opener.open(url).read()</span></span><br><span class="line">    cj._cookies.values()[<span class="number">0</span>][<span class="string">'/'</span>][<span class="string">'info'</span>].value = <span class="string">'the+flowers+are+on+their+way'</span></span><br><span class="line">    violin_source = opener.open(<span class="string">'http://www.pythonchallenge.com/pc/stuff/violin.php'</span>).read()</span><br><span class="line">    <span class="keyword">print</span> violin_source</span><br></pre></td></tr></table></figure></p>
<h3 id="python_challenge_18"><a href="http://www.pythonchallenge.com/pc/return/balloons.html" target="_blank" rel="external">python challenge 18</a></h3><p><code>http://www.pythonchallenge.com/pc/return/balloons.html</code><br><img src="http://o9xrwsn0z.bkt.clouddn.com/python-challenge-18.jpg" alt="18"><br>页面标题：can you tell the difference?<br>明显的两张图片亮度不同，英文brightness.<br>进入该页面后再看源码提示：maybe consider deltas.gz<br>将该文件下载下来，解压后看到delta.txt里是分为两栏的16进制数据。<br><img src="http://o9xrwsn0z.bkt.clouddn.com/python-challenge-18-deltas.jpg" alt="18-deltas"><br>仔细对比两边内容，发现有部分重复的，也就是通过比较两栏内容，来分发字节。<br>左边特有的，右边特有的，公共部分，分别生成三张图片。<br>这里需要用到difflib模块来进行数据处理。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">balloons</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">import</span> difflib</span><br><span class="line">    f_delta = open(<span class="string">'files/delta.txt'</span>, <span class="string">'r+'</span>)</span><br><span class="line">    deltas = f_delta.read().split(<span class="string">'\n'</span>)</span><br><span class="line">    f_delta.close()</span><br><span class="line"></span><br><span class="line">    left_data = []</span><br><span class="line">    right_data = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> deltas:</span><br><span class="line">        left_data.append(line[:<span class="number">53</span>]+<span class="string">'\n'</span>)</span><br><span class="line">        right_data.append(line[<span class="number">56</span>:]+<span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">    diff = difflib.Differ()</span><br><span class="line">    cmp_result = list(diff.compare(left_data, right_data))</span><br><span class="line"></span><br><span class="line">    left_pic = open(<span class="string">'img/18-left-diff.png'</span>, <span class="string">'wb'</span>)</span><br><span class="line">    right_pic = open(<span class="string">'img/18-right-diff.png'</span>, <span class="string">'wb'</span>)</span><br><span class="line">    common_pic = open(<span class="string">'img/18-common.png'</span>, <span class="string">'wb'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> cmp_result:</span><br><span class="line">        bytes = [(chr(int(h, <span class="number">16</span>))) <span class="keyword">for</span> h <span class="keyword">in</span> line[<span class="number">2</span>:].split()]</span><br><span class="line">        <span class="keyword">if</span> line.startswith(<span class="string">'-'</span>):</span><br><span class="line">            map(left_pic.write, bytes)</span><br><span class="line">        <span class="keyword">elif</span> line.startswith(<span class="string">'+'</span>):</span><br><span class="line">            map(right_pic.write, bytes)</span><br><span class="line">        <span class="keyword">elif</span> line.startswith(<span class="string">' '</span>):</span><br><span class="line">            map(common_pic.write, bytes)</span><br><span class="line"></span><br><span class="line">    right_pic.close()</span><br><span class="line">    left_pic.close()</span><br><span class="line">    common_pic.close()</span><br></pre></td></tr></table></figure></p>
<p>最后生成的三张图片<br><img src="http://o9xrwsn0z.bkt.clouddn.com/python-challenge-18-bin.jpg" alt="18-bin"><br>进入<a href="http://www.pythonchallenge.com/pc/hex/bin.html" target="_blank" rel="external">http://www.pythonchallenge.com/pc/hex/bin.html</a><br>用户名：butter 密码：fly</p>
<h3 id="python_challenge_19"><a href="http://www.pythonchallenge.com/pc/hex/bin.html" target="_blank" rel="external">python challenge 19</a></h3><p><code>http://www.pythonchallenge.com/pc/hex/bin.html</code><br><img src="http://o9xrwsn0z.bkt.clouddn.com/python-challenge-19.jpg" alt="19"><br>看网页源码，base64加密一段音频数据indian.wav<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hex_bin</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">import</span> base64</span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">"Authorization"</span>: <span class="string">"Basic YnV0dGVyOmZseQ=="</span></span><br><span class="line">    &#125;</span><br><span class="line">    page_source = requests.get(<span class="string">"http://www.pythonchallenge.com/pc/hex/bin.html"</span>, headers=headers).text</span><br><span class="line">    wav_data = re.findall(<span class="string">r"base64([\s\S]+?)--"</span>, page_source)[<span class="number">0</span>].strip(<span class="string">"\n"</span>)</span><br><span class="line">    indian = open(<span class="string">"files/indian.wav"</span>, <span class="string">"wb"</span>)</span><br><span class="line">    indian.write(base64.b64decode(wav_data))</span><br><span class="line">    indian.close()</span><br></pre></td></tr></table></figure></p>
<p>打开生成的音频文件，有个怪怪的声音：sorry..<br>打开sorry界面显示：what are you apologizing for<br>再回头看看图片，大陆和海洋的颜色是反转的，尝试将音频每一帧反转<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hex_bin</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">import</span> base64</span><br><span class="line">    <span class="keyword">import</span> wave</span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">"Authorization"</span>: <span class="string">"Basic YnV0dGVyOmZseQ=="</span></span><br><span class="line">    &#125;</span><br><span class="line">    page_source = requests.get(<span class="string">"http://www.pythonchallenge.com/pc/hex/bin.html"</span>, headers=headers).text</span><br><span class="line">    wav_data = re.findall(<span class="string">r"base64([\s\S]+?)--"</span>, page_source)[<span class="number">0</span>].strip(<span class="string">"\n"</span>)</span><br><span class="line">    indian = open(<span class="string">"files/indian.wav"</span>, <span class="string">"wb"</span>)</span><br><span class="line">    indian.write(base64.b64decode(wav_data))</span><br><span class="line">    indian.close()</span><br><span class="line"></span><br><span class="line">    indian = wave.open(<span class="string">"files/indian.wav"</span>, <span class="string">"rb"</span>)</span><br><span class="line">    reverse = wave.open(<span class="string">"files/indian-reverse.wav"</span>, <span class="string">"wb"</span>)</span><br><span class="line">    reverse.setnchannels(<span class="number">1</span>)</span><br><span class="line">    reverse.setframerate(indian.getframerate())</span><br><span class="line">    reverse.setsampwidth(indian.getsampwidth())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(indian.getnframes()):</span><br><span class="line">        reverse.writeframes(indian.readframes(<span class="number">1</span>)[::-<span class="number">1</span>])</span><br><span class="line">    indian.close()</span><br><span class="line">    reverse.close()</span><br></pre></td></tr></table></figure></p>
<p>播放下听听，You are a idiot ha ha ha ha ha ha …..<br>进入idiot.html显示：Now you should apologize,Continue to the next level进入下一关。</p>
<h3 id="python_challenge_20"><a href="http://www.pythonchallenge.com/pc/hex/idiot2.html" target="_blank" rel="external">python challenge 20</a></h3><p><code>http://www.pythonchallenge.com/pc/hex/idiot2.html</code><br><img src="http://o9xrwsn0z.bkt.clouddn.com/python-challenge-20.jpg" alt="20"><br>页面标题：go away!<br>图片下边：but inspecting it carefully is allowed.<br>大概意思是围栏那边的是私有财产，请离开私有财产，虽然不允许进入，但可以观察。<br>没有一点思路，谷歌大法好，抓下图片包看下请求头信息：<br><img src="http://o9xrwsn0z.bkt.clouddn.com/python-challenge-20-range.jpg" alt="20-range"><br>这里的Content-Range的值是: bytes 0-30202/2123456789，这看上去与所谓的“断点续传”十分相似。<br>从这个信息知道原始图片大小有2123456789个字节，但是目前的“unreal.jpg” 只有前面的30202 个字节，这就说明看到的“unreal.jpg”并不完整。<br>那就先要把“unreal.jpg”下载完全才行。<br>要指定请求的字节范围，需要在请求中加入一个叫Range的头，基本形式是“Range: bytes=1000-2345”。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">"Authorization"</span>: <span class="string">"Basic YnV0dGVyOmZseQ=="</span>,</span><br><span class="line">    <span class="string">"Range"</span>: <span class="string">"bytes=30203-"</span></span><br><span class="line">&#125;</span><br><span class="line">img = requests.get(<span class="string">"http://www.pythonchallenge.com/pc/hex/unreal.jpg"</span>, headers=headers)</span><br><span class="line"><span class="keyword">print</span> img.text</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="string">u"Why don't you respect my privacy?\n"</span></span><br></pre></td></tr></table></figure></p>
<p>服务器返回了有意义的信息，因此写个遍历将所有信息打印出来。<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">def idiot2():</span><br><span class="line">    pic_url = "http://www.pythonchallenge.com/pc/hex/unreal.jpg"</span><br><span class="line">    next_range = 30203</span><br><span class="line">    end_range = 2123456789</span><br><span class="line">    while next_range &lt;= end_range:</span><br><span class="line">        headers = &#123;</span><br><span class="line">            "Authorization": "Basic YnV0dGVyOmZseQ==",</span><br><span class="line">            "Range": "bytes=%d-" % next_range</span><br><span class="line">        &#125;</span><br><span class="line">        img = requests.get(pic_url, headers=headers)</span><br><span class="line">        if img.status_code == 206:</span><br><span class="line">            print "range : %d -&gt; %s" % (next_range, img.text)</span><br><span class="line">            content_range = img.headers.get("Content-Range")</span><br><span class="line">            next_range = re.findall(r"bytes.+-(\d+)/", content_range)[0]</span><br><span class="line">            next_range = int(next_range) + 1</span><br><span class="line">        else:</span><br><span class="line">            break</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">    range : 30203 -&gt; Why don't you respect my privacy?</span><br><span class="line">    range : 30237 -&gt; we can go on in this way for really long time.</span><br><span class="line">    range : 30284 -&gt; stop this!</span><br><span class="line">    range : 30295 -&gt; invader! invader!</span><br><span class="line">    range : 30313 -&gt; ok, invader. you are inside now.</span><br><span class="line">    Process finished with exit code 0</span><br></pre></td></tr></table></figure></p>
<p>信息中反复提到的入侵者invader，尝试更换下网址为invader.html。<br>页面显示：Yes! that’s you! 这提示，然并卵。。。<br>从前边入侵不行，那就从后边入侵试试？<br>将代码中next_range改为2123456789打印出来为：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">esrever ni emankcin wen ruoy si drowssap eht</span><br></pre></td></tr></table></figure></p>
<p>将其反过来<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">end_text = <span class="string">"esrever ni emankcin wen ruoy si drowssap eht"</span></span><br><span class="line">result = [text_[::-<span class="number">1</span>] <span class="keyword">for</span> text_ <span class="keyword">in</span> end_text.split()[::-<span class="number">1</span>]]</span><br><span class="line"><span class="keyword">print</span> <span class="string">" "</span>.join(result)</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>the password <span class="keyword">is</span> your new nickname <span class="keyword">in</span> reverse</span><br></pre></td></tr></table></figure></p>
<p>通过读取Content-Range再入侵前一个得到信息：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">range : 2123456743 -&gt; and it is hiding at 1152983631.</span><br></pre></td></tr></table></figure></p>
<p>通过这条信息得之其隐藏在1152983631，入侵之后得到pk开头的数据即zip包。<br>将其下载下来，解压需要密码，密码看前边的提示信息：<br>the password is your new nickname in reverse<br>新绰号即为入侵者invader，反过来为redavni。<br>解压过后生成两个文件，package.pack和readme.txt,打开readme文件内容为：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Yes! This <span class="keyword">is</span> really level <span class="number">21</span> <span class="keyword">in</span> here.</span><br><span class="line">And yes, After you solve it, yo<span class="string">u'll be in level 22!</span><br><span class="line"></span><br><span class="line">Now for the level:</span><br><span class="line"></span><br><span class="line">* We used to play this game when we were kids</span><br><span class="line">* When I had no idea what to do, I looked backwards.</span></span><br></pre></td></tr></table></figure></p>
<p>已经进入了level 21.<br>完整代码：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">idiot2</span><span class="params">()</span>:</span></span><br><span class="line">    pic_url = <span class="string">"http://www.pythonchallenge.com/pc/hex/unreal.jpg"</span></span><br><span class="line">    next_range = <span class="number">30203</span></span><br><span class="line">    end_range = <span class="number">2123456789</span></span><br><span class="line">    <span class="keyword">while</span> next_range &lt;= end_range:</span><br><span class="line">        headers = &#123;</span><br><span class="line">            <span class="string">"Authorization"</span>: <span class="string">"Basic YnV0dGVyOmZseQ=="</span>,</span><br><span class="line">            <span class="string">"Range"</span>: <span class="string">"bytes=%d-"</span> % next_range</span><br><span class="line">        &#125;</span><br><span class="line">        img = requests.get(pic_url, headers=headers)</span><br><span class="line">        <span class="keyword">if</span> img.status_code == <span class="number">206</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"range : %d -&gt; %s"</span> % (next_range, img.text)</span><br><span class="line">            content_range = img.headers.get(<span class="string">"Content-Range"</span>)</span><br><span class="line">            next_range = re.findall(<span class="string">r"bytes.+-(\d+)/"</span>, content_range)[<span class="number">0</span>]</span><br><span class="line">            next_range = int(next_range) + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># reverse</span></span><br><span class="line">    cur_range = <span class="number">2123456789</span></span><br><span class="line">    end_range = <span class="number">2123456789</span></span><br><span class="line">    is_download = <span class="keyword">False</span></span><br><span class="line">    <span class="keyword">while</span> cur_range &lt;= end_range:</span><br><span class="line">        headers = &#123;</span><br><span class="line">            <span class="string">"Authorization"</span>: <span class="string">"Basic YnV0dGVyOmZseQ=="</span>,</span><br><span class="line">            <span class="string">"Range"</span>: <span class="string">"bytes=%d-"</span> % cur_range</span><br><span class="line">        &#125;</span><br><span class="line">        img = requests.get(pic_url, headers=headers)</span><br><span class="line">        <span class="keyword">if</span> img.status_code == <span class="number">206</span>:</span><br><span class="line">            <span class="keyword">if</span> is_download <span class="keyword">is</span> <span class="keyword">True</span>:</span><br><span class="line">                open(<span class="string">"files/invader.zip"</span>, <span class="string">"wb"</span>).write(img.content)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">print</span> <span class="string">"range : %d -&gt; %s"</span> % (cur_range, img.text)</span><br><span class="line">            content_range = img.headers.get(<span class="string">"Content-Range"</span>)</span><br><span class="line">            cur_range = re.findall(<span class="string">r"bytes (\d+)-"</span>, content_range)[<span class="number">0</span>]</span><br><span class="line">            cur_range = int(cur_range) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">            img_text = img.text</span><br><span class="line">            result = [text_[::-<span class="number">1</span>] <span class="keyword">for</span> text_ <span class="keyword">in</span> img_text.split()[::-<span class="number">1</span>]]</span><br><span class="line">            <span class="keyword">print</span> <span class="string">" "</span>.join(result)</span><br><span class="line">        <span class="keyword">elif</span> img.status_code == <span class="number">416</span>:</span><br><span class="line">            cur_range = img_text.split()[-<span class="number">1</span>].strip(<span class="string">"."</span>)</span><br><span class="line">            cur_range = int(cur_range)</span><br><span class="line">            is_download = <span class="keyword">True</span></span><br></pre></td></tr></table></figure></p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://blog.idhyt.com/2015/08/10/python-challenge-11-20/" data-id="cixf0i3e4002gc46i7mm6hx0d" class="article-share-link">Share</a><div class="tags"><a href="/tags/challenge/">challenge</a></div><div class="post-nav"><a href="/2015/08/13/python-challenge-21-27/" class="pre">python challenge 21-27</a><a href="/2015/08/07/python-challenge-0-10/" class="next">python challenge 0-10</a></div><div id="disqus_thread"><script>var disqus_shortname = 'idhyt';
var disqus_identifier = '2015/08/10/python-challenge-11-20/';
var disqus_title = 'python challenge 11-20';
var disqus_url = 'http://blog.idhyt.com/2015/08/10/python-challenge-11-20/';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//idhyt.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><input placeholder="Search" type="text" class="st-default-search-input"/></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Social</i></div><ul></ul><a href="http://github.com/idhyt" title="GitHub" target="_blank">GitHub</a><ul></ul><a href="https://twitter.com/idhyt3r" title="Twitter" target="_blank">Twitter</a><ul></ul><a href="http://weibo.com/idhyt" title="Weibo" target="_blank">Weibo</a><ul></ul><a href="http://www.zhihu.com/people/idhyt" title="ZhiHu" target="_blank">ZhiHu</a></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/android/">android</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/diary/">diary</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/exploit/">exploit</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/study/">study</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/technic/">technic</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/virus/">virus</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/uac/" style="font-size: 15px;">uac</a> <a href="/tags/淘宝客/" style="font-size: 15px;">淘宝客</a> <a href="/tags/过滤/" style="font-size: 15px;">过滤</a> <a href="/tags/盗号/" style="font-size: 15px;">盗号</a> <a href="/tags/推广/" style="font-size: 15px;">推广</a> <a href="/tags/流氓/" style="font-size: 15px;">流氓</a> <a href="/tags/感染/" style="font-size: 15px;">感染</a> <a href="/tags/下载/" style="font-size: 15px;">下载</a> <a href="/tags/xss/" style="font-size: 15px;">xss</a> <a href="/tags/sql/" style="font-size: 15px;">sql</a> <a href="/tags/lol/" style="font-size: 15px;">lol</a> <a href="/tags/shellcode/" style="font-size: 15px;">shellcode</a> <a href="/tags/english/" style="font-size: 15px;">english</a> <a href="/tags/challenge/" style="font-size: 15px;">challenge</a> <a href="/tags/task/" style="font-size: 15px;">task</a> <a href="/tags/thread/" style="font-size: 15px;">thread</a> <a href="/tags/驱动/" style="font-size: 15px;">驱动</a> <a href="/tags/cve/" style="font-size: 15px;">cve</a> <a href="/tags/nvidia/" style="font-size: 15px;">nvidia</a> <a href="/tags/kernel/" style="font-size: 15px;">kernel</a> <a href="/tags/symbol/" style="font-size: 15px;">symbol</a> <a href="/tags/libstagefright/" style="font-size: 15px;">libstagefright</a> <a href="/tags/pingpongroot/" style="font-size: 15px;">pingpongroot</a> <a href="/tags/iovyroot/" style="font-size: 15px;">iovyroot</a> <a href="/tags/pxn/" style="font-size: 15px;">pxn</a> <a href="/tags/无法描述/" style="font-size: 15px;">无法描述</a> <a href="/tags/smali/" style="font-size: 15px;">smali</a> <a href="/tags/debug/" style="font-size: 15px;">debug</a> <a href="/tags/xposed/" style="font-size: 15px;">xposed</a> <a href="/tags/adb/" style="font-size: 15px;">adb</a> <a href="/tags/webview/" style="font-size: 15px;">webview</a> <a href="/tags/android/" style="font-size: 15px;">android</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/01/01/diary-annual-summary-2016/">我的2016</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/09/exploit-kernel-security-flaws/">KERNEL SECURITY FLAWS (0day for nexus4)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/26/exploit-illegal-access-caused-by-an-empty-list/">ILLEGAL ACCESS CAUSED BY AN EMPTY LIST</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/24/exploit-cve-2016-5195/">CVE-2016-5195</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/04/exploit-perf_event-vul/">PERF_EVENT VUL</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/09/exploit-bypass-pxn/">绕过PXN保护</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/07/exploit-cve-2015-1805/">CVE-2015-1805</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/09/exploit-process-descriptor/">进程描述符</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/09/exploit-kernel-symbol-usage/">如何优雅的使用内核符号表</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/02/diary-stay-away-trip/">一场说走就走的旅行</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> Recent Comments</i></div><script type="text/javascript" src="//idhyt.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="http://blog.idhyt.com/about" title="About" target="_blank">About</a><ul></ul><a href="undefined" title="undefined" target="_blank"></a><ul></ul><a href="undefined" title="undefined" target="_blank"></a><ul></ul><a href="undefined" title="undefined" target="_blank"></a><ul></ul><a href="undefined" title="undefined" target="_blank"></a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">idhyt's blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><!-- a(rel='nofollow', target='_blank', href='https://github.com/tufu9441/maupassant-hexo')  Theme--><!-- |  by--><!-- a(rel='nofollow', target='_blank', href='https://github.com/pagecho')  Cho.--></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

_st('install','sVJDxDCDcUGeK1KkM6zN','2.0.0');
</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-71783676-1','auto');ga('send','pageview');
</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?5228d77c5752954f270fcca0908555af";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>